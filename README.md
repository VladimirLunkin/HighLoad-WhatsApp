# HighLoad-WhatsApp
Технопарк Mail.ru 3 семестр. Домашнее задание №1 по курсу "HighLoad".

## 1. Тема и целевая аудитория

**WhatsApp** - Cервис обмена мгновенными сообщениями.

### MVP
 - регистрация
 - чат (текстовые сообщения, голосовые сообщения, отправка файлов)
 - групповой чат


### Целевая аудитория

WhatsApp имеет более 2 миллиардов активных пользователей в месяц по всему миру. [[1]](https://www.statista.com/topics/2018/whatsapp/#dossierKeyfigures)

**Страна**|**Количество пользователей в месяц, млн**
---|---
Индия|390,1
Бразилия|108,
Соединенные Штаты|75,1
Индонезия|68,8
Россия|64,7
Мексика|62,3
Германия|48,3
Италия|35,5
Испания|33,0
Соединенное Королевство|30,1


## 2. Расчет нагрузки

Ежедневно через WhatsApp отправляется более 100 миллиардов сообщений. [[2]](https://www.affde.com/ru/whatsapp-users.html)

### Продуктовые метрики

* **Месячная аудитория** - 2 млрд.
* **Дневная аудитория** - 1,5 млрд. [[3]](https://vc.ru/social/25453-whatsapp-1b-daily) (с пересчетом на настоящее время)
* **Средний размер хранилища пользователя**

  WhatsApp не хранит на серверах доставленные сообщения и файлы пользователей. Непрочитанные сообщения удаляются через 30 дней.
  В среднем пользователь отправляет 100млрд(сообщений) / 1.5млрд(пользователей) = 66 сообщений в день. Вес одного сообщения в среднем - 200 Кбайт.
  Из личного опыта, сообщения прочитываются в течении суток, значит на сервере сообщения необходимо хранить 24 часа. Отсюда следует, что хранилище для одного пользователя
  66 * 200 Кбайт * 30 дней = 387 Мбайт
* **Среднее количество действий пользователя по типам в день**

  **Действие**|**Среднее количество в день**
  ---|---
  Отправка сообщения|66
  Получение сообщений|180

  **Действие**|**Среднее количество в месяц**
  ---|---
  Создание группового чата|1
  Добавление в группововй чат|3

### Технические метрики

* **Размер хранения**
  
  На одного пользователя 387 Мбайт, тогда на 2 млрд пользователей:
  387 Мбайт * 2 млрд = 740 144 Тб
  
* **Сетевой трафик**
 
  Сообщения: 100млрд * 200Кб * 2 (отправка и получение) = 37 252 Тб/сутки
 
* **RPS в разбивке по типам запросов**
  
  Отправка сообщения: 100млрд / 86400 секунд = 1158000 RPS
  Получение сообщения: Пусть один пользователь 10 раз в день запрашивает новые сообщеня, тогда 10 * 1.5 млрд / 86400 секунд = 173611 RPS
  Создание группового чата: в месяц 2 млрд. 2 млрд / (30 дней * 86400 секунд) = 771 RPS
  Добавление в группововй чат: в месяц 2 млрд * 3 = 6 млрд. 6 млрд / (30 дней * 86400 секунд) = 2313 RPS

  **Действие**|**RPS**
  ---|---
  Отправка сообщения|1158000
  Получение сообщений|173611
  Создание группового чата|771
  Добавление в группововй чат|2313

## Ссылки на источники
1. https://www.statista.com/topics/2018/whatsapp/#dossierKeyfigures
2. https://www.affde.com/ru/whatsapp-users.html
3. https://vc.ru/social/25453-whatsapp-1b-daily
